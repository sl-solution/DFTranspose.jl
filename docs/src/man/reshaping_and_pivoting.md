# Reshaping and Pivoting Data

The function `df_transpose` provide a unified way to reshape data. The function transposes selected columns of a data set. When a set of grouping variables is given `df_transpose` performs transposing within each group.
For example in the following code, we read `iris` data and stack the numeric columns, i.e. transpose numeric columns of each row of `iris`. To achieve this we add `rowID` columns to the data and apply a simple transpose within each row:

```jldoctest reshape
julia> using DataFrames, CSV, DFTranspose

julia> iris = CSV.read((joinpath(dirname(pathof(DataFrames)),
                                 "..", "docs", "src", "assets", "iris.csv")),
                       DataFrame)
150×5 DataFrame
 Row │ SepalLength  SepalWidth  PetalLength  PetalWidth  Species
     │ Float64      Float64     Float64      Float64     String
─────┼──────────────────────────────────────────────────────────────────
   1 │         5.1         3.5          1.4         0.2  Iris-setosa
   2 │         4.9         3.0          1.4         0.2  Iris-setosa
   3 │         4.7         3.2          1.3         0.2  Iris-setosa
   4 │         4.6         3.1          1.5         0.2  Iris-setosa
   5 │         5.0         3.6          1.4         0.2  Iris-setosa
   6 │         5.4         3.9          1.7         0.4  Iris-setosa
   7 │         4.6         3.4          1.4         0.3  Iris-setosa
   8 │         5.0         3.4          1.5         0.2  Iris-setosa
  ⋮  │      ⋮           ⋮            ⋮           ⋮             ⋮
 144 │         6.8         3.2          5.9         2.3  Iris-virginica
 145 │         6.7         3.3          5.7         2.5  Iris-virginica
 146 │         6.7         3.0          5.2         2.3  Iris-virginica
 147 │         6.3         2.5          5.0         1.9  Iris-virginica
 148 │         6.5         3.0          5.2         2.0  Iris-virginica
 149 │         6.2         3.4          5.4         2.3  Iris-virginica
 150 │         5.9         3.0          5.1         1.8  Iris-virginica
                                                        135 rows omitted

julia> insertcols!(iris, 1, :rowID => 1:nrow(iris))
julia> df_transpose(iris, 2:5, [:rowID, :Species])
600×4 DataFrame
 Row │ rowID  Species         _variables_  _c1     
     │ Int64  String          String       Float64
─────┼─────────────────────────────────────────────
   1 │     1  Iris-setosa     SepalLength      5.1
   2 │     1  Iris-setosa     SepalWidth       3.5
   3 │     1  Iris-setosa     PetalLength      1.4
   4 │     1  Iris-setosa     PetalWidth       0.2
   5 │     2  Iris-setosa     SepalLength      4.9
   6 │     2  Iris-setosa     SepalWidth       3.0
   7 │     2  Iris-setosa     PetalLength      1.4
   8 │     2  Iris-setosa     PetalWidth       0.2
   9 │     3  Iris-setosa     SepalLength      4.7
  10 │     3  Iris-setosa     SepalWidth       3.2
  11 │     3  Iris-setosa     PetalLength      1.3
  ⋮  │   ⋮          ⋮              ⋮          ⋮
 591 │   148  Iris-virginica  PetalLength      5.2
 592 │   148  Iris-virginica  PetalWidth       2.0
 593 │   149  Iris-virginica  SepalLength      6.2
 594 │   149  Iris-virginica  SepalWidth       3.4
 595 │   149  Iris-virginica  PetalLength      5.4
 596 │   149  Iris-virginica  PetalWidth       2.3
 597 │   150  Iris-virginica  SepalLength      5.9
 598 │   150  Iris-virginica  SepalWidth       3.0
 599 │   150  Iris-virginica  PetalLength      5.1
 600 │   150  Iris-virginica  PetalWidth       1.8
                                   579 rows omitted
```

The second argument to `df_transpose` is the columns which are going to be transpose
 (usually some numeric columns) and the third argument specifies the set of grouping variables.
The labels for columns `_variables_` and `_c1` are generated by default, however,
this can be customised by using optional arguments `variable_name`, `renamecolid`.

```jldoctest reshape
julia> df_transpose(iris, [:SepalLength, :SepalWidth, :PetalLength, :PetalWidth],
                    ["rowID", "Species"],
                    variable_name = :variable,
                    renamecolid = x -> "value")
600×4 DataFrame
Row │ rowID  Species         variable     value   
    │ Int64  String          String       Float64
────┼─────────────────────────────────────────────
  1 │     1  Iris-setosa     SepalLength      5.1
  2 │     1  Iris-setosa     SepalWidth       3.5
  3 │     1  Iris-setosa     PetalLength      1.4
  4 │     1  Iris-setosa     PetalWidth       0.2
  5 │     2  Iris-setosa     SepalLength      4.9
  6 │     2  Iris-setosa     SepalWidth       3.0
  7 │     2  Iris-setosa     PetalLength      1.4
  8 │     2  Iris-setosa     PetalWidth       0.2
  9 │     3  Iris-setosa     SepalLength      4.7
 10 │     3  Iris-setosa     SepalWidth       3.2
 11 │     3  Iris-setosa     PetalLength      1.3
 ⋮  │   ⋮          ⋮              ⋮          ⋮
591 │   148  Iris-virginica  PetalLength      5.2
592 │   148  Iris-virginica  PetalWidth       2.0
593 │   149  Iris-virginica  SepalLength      6.2
594 │   149  Iris-virginica  SepalWidth       3.4
595 │   149  Iris-virginica  PetalLength      5.4
596 │   149  Iris-virginica  PetalWidth       2.3
597 │   150  Iris-virginica  SepalLength      5.9
598 │   150  Iris-virginica  SepalWidth       3.0
599 │   150  Iris-virginica  PetalLength      5.1
600 │   150  Iris-virginica  PetalWidth       1.8
                                  579 rows omitted
```

Note that `renamecolid` is a function which its input is the sequence of integer, and
its output is the label for the columns in the output.
